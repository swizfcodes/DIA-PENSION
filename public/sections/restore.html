<!-- Recall Payment Files Section -->
<div class="p-6">
  <div class="flex items-center justify-between mb-4">
    <div class="flex items-center space-x-3">
      <!-- Icon -->
      <div class="bg-yellow-500 text-white p-3 rounded-full shadow">
        ðŸ’¾
      </div>
      <h2 class="text-2xl font-bold text-yellow-600">Restore Payroll Files</h2>
    </div>
  </div>

  <!-- Description -->
  <p class="text-gray-600 font-semibold lg:text-lg mb-6">Restore previously saved payroll files for adjustments or review if needed.</p>

  <!-- Action -->
  <div class="flex justify-center">
    <button id="openRecallModalBtn" class="px-8 py-3 bg-yellow-500 text-white rounded-lg shadow hover:bg-yellow-600 transition">
      Restore Payroll Files
    </button>
  </div>
</div>

<!-- Confirmation Modal -->
<div id="recallModal" class="fixed inset-0 bg-black bg-opacity-40 hidden flex items-center justify-center z-50">
  <div class="bg-white w-11/12 md:w-1/3 rounded-xl shadow-lg overflow-hidden">
    <!-- Header -->
    <div class="flex justify-between items-center bg-yellow-500 text-white px-4 py-3">
      <h3 class="text-lg font-semibold">Confirm Restore</h3>
      <button id="closeRecallModalBtn" class="text-white hover:text-gray-200">âœ–</button>
    </div>

    <!-- Body -->
    <div class="p-6">
      <p class="text-gray-700 mb-4">Are you sure you want to <span class="font-semibold">restore payroll files</span>? This action will bring them back for review or adjustment.</p>
      <div id="recallStatus" class="hidden text-yellow-700 font-semibold mt-2"></div>
    </div>

    <!-- Footer -->
    <div class="flex justify-end space-x-3 bg-gray-100 px-4 py-3">
      <button id="cancelRecallBtn" class="px-6 py-2 bg-gray-300 hover:bg-gray-400 rounded-lg">Cancel</button>
      <button id="confirmRecallBtn" class="px-6 py-2 bg-yellow-500 hover:bg-yellow-600 text-white rounded-lg">Yes, Restore</button>
    </div>
  </div>
</div>

<script>
(function () {
  const modal = document.getElementById("recallModal");
  const openBtn = document.getElementById("openRecallModalBtn");
  const closeBtn = document.getElementById("closeRecallModalBtn");
  const cancelBtn = document.getElementById("cancelRecallBtn");
  const confirmBtn = document.getElementById("confirmRecallBtn");
  const statusEl = document.getElementById("recallStatus");

  // Open modal
  openBtn.addEventListener("click", () => {
    modal.classList.remove("hidden");
    statusEl.classList.add("hidden");
    statusEl.textContent = "";
  });

  // Close modal
  function closeModal() {
    modal.classList.add("hidden");
  }
  closeBtn.addEventListener("click", closeModal);
  cancelBtn.addEventListener("click", closeModal);

  // Frontend: /public/js/payroll-calculations.js
  async function runRestore() {
    // Confirmation dialog
    if (!confirm('âš ï¸ Are you SURE you want to restore from backup?\n\nThis will undo all calculations!')) {
      return;
    }

    try {
      showNotification('Restoring from backup...', 'info');
      
      const response = await fetch('/restore', {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json',
          'Authorization': `Bearer ${localStorage.getItem('token')}`
        },
        body: JSON.stringify({
          year: 2025,
          month: 10
        })
      });

      const result = await response.json();
      
      if (result.success) {
        showNotification('âœ… Backup restored. You can now re-run calculations.', 'success');
      } else {
        showNotification('âŒ Restore failed: ' + result.message, 'error');
      }
    } catch (error) {
      showNotification('âŒ Error: ' + error.message, 'error');
    }
  }

  //document.getElementById('btnRestore').addEventListener('click', runRestore);

  // Confirm recall (simulate)
  confirmBtn.addEventListener("click", () => {
    statusEl.classList.remove("hidden");
    statusEl.textContent = "Restoring payroll files...";
    confirmBtn.disabled = true;

    runRestore();

    setTimeout(() => {
      statusEl.textContent = "âœ… Payroll files successfully restored.";
      confirmBtn.disabled = false;
      setTimeout(closeModal, 2000);
    }, 1500);
  });
})();
</script>




